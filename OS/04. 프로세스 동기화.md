# Chapter 12 : 프로세스 동기화

## 동기화란

### 동기화의 의미

- 동시다발적으로 실행되는 많은 프로세스는 서로 데이터를 주고받고 협력하며 실행될 수 있다.
- 이렇게 협력적으로 실행되는 프로세스는 마구 동시에 실행해선 안되고, **동기화**가 필수이다.
- **프로세스 동기화**란 프로세스들 사이의 수행 시기를 맞추는 것을 의미한다.
- 수행 시기를 맞추는 것은 크게 아래 두 가지를 일컫는다.
  1. 실행 순서 제어 : 프로세스를 올바른 순서대로 실행하기
  2. 상호 배제 : 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하기
- 즉, 동기화는 특정 자원에 접근할 때 한 개의 프로세스만 접근하게 하거나, 올바른 순서대로 실행하게 하는 것을 의미한다.
- 동기화에는 실행 순서 제어를 위한 동기화와, 상호 배제를 위한 동기화가 있다.
- **실행 순서 제어를 위한 동기화**
  - 만약 reader 프로세스와 writer 프로세스가 동시에 실행된다면, 반드시 writer 프로세스가 먼저 실행되어 데이터가 쓰여져야 reader 프로세스를 실행할 수 있다.
  - 이런 경우를 위해 동시에 실행되는 프로세스를 올바른 순서대로 실행할 수 있어야 한다.
- **상호 배제를 위한 동기화**
  - 공유가 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘이다.
  - 동기화가 제대로 이루어지지 않으면, 예를 들어 변수의 값에 영향을 주는 프로세스들이 여러 개 실행될 때 제대로 저장이 이루어지지 않을 수 있다.
  - 반드시 동시 사용이 불가능한 데이터를 사용할 때에는 해당 데이터를 사용하는 프로세스가 사용이 종료되어야 다음 프로세스가 접근하도록 해야 한다.

### 생산자와 소비자 문제

- 상호 배제를 위한 동기화 중 고전적이고 유명한 문제로 **생산자와 소비자 문제**가 있다.
- 이 문제는 물건을 계속해서 생산하는 프로세스인 생산자와, 물건을 계속해서 소비하는 프로세스인 소비자로 이루어져 있다.
- 총합이라는 변수에 10을 초기화하고, 이 프로세스들을 동시에 각각 100,000번 동시에 실행하면 10 그대로 있어야 할 것 같지만 실행 결과 매우 이상한 값이 나타난다.
- 이것은 프로세스가 제대로 동기화되지 않았기 때문에 발생한 문제이다.
- 생산자가 소비자의 작업이 끝나기도 전에 총합을 수정하고, 반대로 소비자도 생산자의 작업이 끝나기도 전에 총합을 수정하니 발생하는 문제이다.